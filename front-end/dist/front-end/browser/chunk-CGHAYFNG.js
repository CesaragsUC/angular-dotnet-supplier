import{a as It,b as Et,c as Rt,d as zt,e as Ft}from"./chunk-GM3SB2OC.js";import{$ as F,A as pt,Aa as ze,Ab as We,Ba as pe,Ca as J,Cb as Ue,D as mt,Da as Z,E as Yt,Ea as ee,Eb as X,Fa as ft,Fb as je,G as P,Ga as l,Gb as Qe,H as ae,Ha as te,Hb as Ne,Ia as b,Ib as qe,J as se,Jb as Ye,Kb as bt,L as R,La as xt,Lb as St,M as ce,Ma as A,Na as Fe,Nb as ve,Pa as Te,Pb as G,R as lt,Rb as At,S as v,Sa as vt,T as _,Ta as _t,W as $,Wa as E,X as dt,Y as Ie,Ya as Oe,Za as me,_ as T,_a as le,a as k,b as st,ba as ht,bb as Ve,bc as he,ca as m,cb as He,da as C,db as q,eb as Ct,i as B,ja as Ee,ka as y,kb as yt,la as $e,lb as Mt,ma as d,mb as de,na as U,nb as wt,o as Ae,oa as Re,ob as Y,p as xe,pb as ke,qa as s,r as Ke,ra as a,rb as Je,sa as h,ta as gt,tb as Be,ua as ut,ub as Le,v as K,va as N,wa as w,wb as S,xa as u,xb as De,y as ct,yb as Pe}from"./chunk-LAJ6XXPO.js";q();E();ve();var ge=class extends It{produto;fornecedores;errors=[];produtoForm;constructor(){super(),this.validationMessages={fornecedorId:{required:"Escolha um fornecedor"},nome:{required:"Informe o Nome",minlength:"M\xEDnimo de 2 caracteres",maxlength:"M\xE1ximo de 200 caracteres"},descricao:{required:"Informe a Descri\xE7\xE3o",minlength:"M\xEDnimo de 2 caracteres",maxlength:"M\xE1ximo de 1000 caracteres"},imagem:{required:"Informe a Imagem"},valor:{required:"Informe o Valor"}},super.configurarMensagensValidacaoBase(this.validationMessages)}configurarValidacaoFormulario(p){super.configurarValidacaoFormularioBase(p,this.produtoForm)}};var ie=class{static StringParaDecimal(p){return p===null?0:(p=p.replace(/\./g,""),p=p.replace(/,/g,"."),parseFloat(p))}static DecimalParaString(p){var e=p?p.toString().replace(".",","):null;if(e){var t=e.split(",");if(t.length>1){var i=t[1].length;i===1&&(e+="0")}}return e}};E();ve();mt();E();var O=(()=>{class o extends At{http;constructor(e){super(),this.http=e}obterTodos(){return this.http.get(this.urlService+"produtos",super.obterAuthHeaderJson()).pipe(K(super.serviceError))}obterPorId(e){return this.http.get(this.urlService+"produtos/"+e,super.obterAuthHeaderJson()).pipe(K(super.serviceError))}novoProduto(e){return this.http.post(this.urlService+"produtos",e,super.obterAuthHeaderJson()).pipe(Ae(super.extractData),K(super.serviceError))}atualizarProduto(e){return this.http.put(this.urlService+"produtos/"+e.id,e,super.obterAuthHeaderJson()).pipe(Ae(super.extractData),K(super.serviceError))}excluirProduto(e){return this.http.delete(this.urlService+"produtos/"+e,super.obterAuthHeaderJson()).pipe(Ae(super.extractData),K(super.serviceError))}obterFornecedores(){return this.http.get(this.urlService+"fornecedores").pipe(K(super.serviceError))}static \u0275fac=function(t){return new(t||o)(se(Ct))};static \u0275prov=P({token:o,factory:o.\u0275fac})}return o})();q();E();E();Yt();mt();q();q();var Xt=["wrapper"],Gt=["sourceImage"];function Kt(o,p){if(o&1){let e=N();s(0,"img",5,1),w("load",function(){v(e);let i=u();return _(i.imageLoadedInView())})("mousedown",function(i){v(e);let r=u();return _(r.startMove(i,r.moveTypes.Drag))})("touchstart",function(i){v(e);let r=u();return _(r.startMove(i,r.moveTypes.Drag))})("error",function(i){v(e);let r=u();return _(r.loadImageError(i))}),a()}if(o&2){let e=u();U("visibility",e.imageVisible?"visible":"hidden")("transform",e.safeTransformStyle),Re("ngx-ic-draggable",!e.disabled&&e.allowMoveImage),d("src",e.safeImgDataUrl,F),$e("alt",e.imageAltText)}}function $t(o,p){if(o&1){let e=N();gt(0),s(1,"span",9),w("mousedown",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"topleft"))})("touchstart",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"topleft"))}),h(2,"span",10),a(),s(3,"span",11),h(4,"span",10),a(),s(5,"span",12),w("mousedown",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"topright"))})("touchstart",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"topright"))}),h(6,"span",10),a(),s(7,"span",13),h(8,"span",10),a(),s(9,"span",14),w("mousedown",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"bottomright"))})("touchstart",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"bottomright"))}),h(10,"span",10),a(),s(11,"span",15),h(12,"span",10),a(),s(13,"span",16),w("mousedown",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"bottomleft"))})("touchstart",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"bottomleft"))}),h(14,"span",10),a(),s(15,"span",17),h(16,"span",10),a(),s(17,"span",18),w("mousedown",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"top"))})("touchstart",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"top"))}),a(),s(18,"span",19),w("mousedown",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"right"))})("touchstart",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"right"))}),a(),s(19,"span",20),w("mousedown",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"bottom"))})("touchstart",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"bottom"))}),a(),s(20,"span",21),w("mousedown",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"left"))})("touchstart",function(i){v(e);let r=u(2);return _(r.startMove(i,r.moveTypes.Resize,"left"))}),a(),ut()}}function Jt(o,p){if(o&1){let e=N();s(0,"div",6),w("keydown",function(i){v(e);let r=u();return _(r.keyboardAccess(i))}),s(1,"div",7),w("mousedown",function(i){v(e);let r=u();return _(r.startMove(i,r.moveTypes.Move))})("touchstart",function(i){v(e);let r=u();return _(r.startMove(i,r.moveTypes.Move))}),a(),y(2,$t,21,0,"ng-container",8),a()}if(o&2){let e=u();U("top",e.cropper.y1,"px")("left",e.cropper.x1,"px")("width",e.cropper.x2-e.cropper.x1,"px")("height",e.cropper.y2-e.cropper.y1,"px")("margin-left",e.alignImage==="center"?e.marginLeft:null)("visibility",e.imageVisible?"visible":"hidden"),Re("ngx-ic-round",e.roundCropper),$e("aria-label",e.cropperFrameAriaLabel),m(2),d("ngIf",!e.hideResizeSquares)}}var Ze=class{constructor(){this.format="png",this.output="blob",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperFrameAriaLabel="Crop photo",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(p){Object.keys(p).filter(e=>e in this).forEach(e=>this[e]=p[e]),this.validateOptions()}setOptionsFromChanges(p){Object.keys(p).filter(e=>e in this).forEach(e=>this[e]=p[e].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}},V=function(o){return o.Drag="drag",o.Move="move",o.Resize="resize",o.Pinch="pinch",o}(V||{});function Zt(o){switch(o){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}function ei(o){switch(o){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}function ti(o,p){switch(o){case"ArrowUp":return{clientX:0,clientY:p*-1};case"ArrowRight":return{clientX:p,clientY:0};case"ArrowDown":return{clientX:0,clientY:p};case"ArrowLeft":default:return{clientX:p*-1,clientY:0}}}function ii(o,p,e){let t=o.width,i=o.height;p=Math.round(p),e=Math.round(e);let r=t/p,n=i/e,c=Math.ceil(r/2),g=Math.ceil(n/2),x=o.getContext("2d");if(x){let f=x.getImageData(0,0,t,i),M=x.createImageData(p,e),I=f.data,W=M.data;for(let j=0;j<e;j++)for(let Q=0;Q<p;Q++){let D=(Q+j*p)*4,H=j*n,z=0,we=0,et=0,tt=0,it=0,rt=0,ot=0,jt=Math.floor(Q*r),Qt=Math.floor(j*n),Xe=Math.ceil((Q+1)*r),Ge=Math.ceil((j+1)*n);Xe=Math.min(Xe,t),Ge=Math.min(Ge,i);for(let be=Qt;be<Ge;be++){let nt=Math.abs(H-be)/g,Nt=Q*r,qt=nt*nt;for(let Se=jt;Se<Xe;Se++){let at=Math.abs(Nt-Se)/c,oe=Math.sqrt(qt+at*at);if(oe>=1)continue;z=2*oe*oe*oe-3*oe*oe+1;let ne=4*(Se+be*t);ot+=z*I[ne+3],et+=z,I[ne+3]<255&&(z=z*I[ne+3]/250),tt+=z*I[ne],it+=z*I[ne+1],rt+=z*I[ne+2],we+=z}}W[D]=tt/we,W[D+1]=it/we,W[D+2]=rt/we,W[D+3]=ot/et}o.width=p,o.height=e,x.putImageData(M,0,0)}}function Tt(o,p){return o/100*p}var ri=(()=>{class o{crop(e,t,i,r,n){let c=this.getImagePosition(e,t,i,n),g=c.x2-c.x1,x=c.y2-c.y1,f=document.createElement("canvas");f.width=g,f.height=x;let M=f.getContext("2d");if(!M)return null;i.backgroundColor!=null&&(M.fillStyle=i.backgroundColor,M.fillRect(0,0,g,x));let I=(i.transform.scale||1)*(i.transform.flipH?-1:1),W=(i.transform.scale||1)*(i.transform.flipV?-1:1),{translateH:j,translateV:Q}=this.getCanvasTranslate(e,i,n),D=e.transformed;M.setTransform(I,0,0,W,D.size.width/2+j,D.size.height/2+Q),M.translate(-c.x1/I,-c.y1/W),M.rotate((i.transform.rotate||0)*Math.PI/180),M.drawImage(D.image,-D.size.width/2,-D.size.height/2);let H={width:g,height:x,imagePosition:c,cropperPosition:k({},t)};i.containWithinAspectRatio&&(H.offsetImagePosition=this.getOffsetImagePosition(e,t,i,n));let z=this.getResizeRatio(g,x,i);return z!==1&&(H.width=Math.round(g*z),H.height=i.maintainAspectRatio?Math.round(H.width/i.aspectRatio):Math.round(x*z),ii(f,H.width,H.height)),r==="blob"?this.cropToBlob(H,f,i):(H.base64=f.toDataURL("image/"+i.format,this.getQuality(i)),H)}cropToBlob(e,t,i){return B(this,null,function*(){return e.blob=yield new Promise(r=>t.toBlob(r,"image/"+i.format,this.getQuality(i))),e.blob&&(e.objectUrl=URL.createObjectURL(e.blob)),e})}getCanvasTranslate(e,t,i){if(t.transform.translateUnit==="px"){let r=this.getRatio(e,i);return{translateH:(t.transform.translateH||0)*r,translateV:(t.transform.translateV||0)*r}}else return{translateH:t.transform.translateH?Tt(t.transform.translateH,e.transformed.size.width):0,translateV:t.transform.translateV?Tt(t.transform.translateV,e.transformed.size.height):0}}getRatio(e,t){return e.transformed.size.width/t.width}getImagePosition(e,t,i,r){let n=this.getRatio(e,r),c={x1:Math.round(t.x1*n),y1:Math.round(t.y1*n),x2:Math.round(t.x2*n),y2:Math.round(t.y2*n)};return i.containWithinAspectRatio||(c.x1=Math.max(c.x1,0),c.y1=Math.max(c.y1,0),c.x2=Math.min(c.x2,e.transformed.size.width),c.y2=Math.min(c.y2,e.transformed.size.height)),c}getOffsetImagePosition(e,t,i,r){let n=i.canvasRotation+e.exifTransform.rotate,c=this.getRatio(e,r),g,x;n%2?(g=(e.transformed.size.width-e.original.size.height)/2,x=(e.transformed.size.height-e.original.size.width)/2):(g=(e.transformed.size.width-e.original.size.width)/2,x=(e.transformed.size.height-e.original.size.height)/2);let f={x1:Math.round(t.x1*c)-g,y1:Math.round(t.y1*c)-x,x2:Math.round(t.x2*c)-g,y2:Math.round(t.y2*c)-x};return i.containWithinAspectRatio||(f.x1=Math.max(f.x1,0),f.y1=Math.max(f.y1,0),f.x2=Math.min(f.x2,e.transformed.size.width),f.y2=Math.min(f.y2,e.transformed.size.height)),f}getResizeRatio(e,t,i){let r=i.resizeToWidth/e,n=i.resizeToHeight/t,c=new Array;i.resizeToWidth>0&&c.push(r),i.resizeToHeight>0&&c.push(n);let g=c.length===0?1:Math.min(...c);return g>1&&!i.onlyScaleDown?g:Math.min(g,1)}getQuality(e){return Math.min(1,Math.max(0,e.imageQuality/100))}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=P({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),oi=(()=>{class o{resetCropperPosition(e,t,i,r){if(e?.nativeElement)if(i.cropperStaticHeight&&i.cropperStaticWidth)t.x1=0,t.x2=r.width>i.cropperStaticWidth?i.cropperStaticWidth:r.width,t.y1=0,t.y2=r.height>i.cropperStaticHeight?i.cropperStaticHeight:r.height;else{let n=Math.min(i.cropperScaledMaxWidth,r.width),c=Math.min(i.cropperScaledMaxHeight,r.height);if(!i.maintainAspectRatio)t.x1=0,t.x2=n,t.y1=0,t.y2=c;else if(r.width/i.aspectRatio<r.height){t.x1=0,t.x2=n;let g=n/i.aspectRatio;t.y1=(r.height-g)/2,t.y2=t.y1+g}else{t.y1=0,t.y2=c;let g=c*i.aspectRatio;t.x1=(r.width-g)/2,t.x2=t.x1+g}}}move(e,t,i){let r=this.getClientX(e)-t.clientX,n=this.getClientY(e)-t.clientY;i.x1=t.x1+r,i.y1=t.y1+n,i.x2=t.x2+r,i.y2=t.y2+n}resize(e,t,i,r,n){let c=this.getClientX(e)-t.clientX,g=this.getClientY(e)-t.clientY;switch(t.position){case"left":i.x1=Math.min(Math.max(t.x1+c,i.x2-n.cropperScaledMaxWidth),i.x2-n.cropperScaledMinWidth);break;case"topleft":i.x1=Math.min(Math.max(t.x1+c,i.x2-n.cropperScaledMaxWidth),i.x2-n.cropperScaledMinWidth),i.y1=Math.min(Math.max(t.y1+g,i.y2-n.cropperScaledMaxHeight),i.y2-n.cropperScaledMinHeight);break;case"top":i.y1=Math.min(Math.max(t.y1+g,i.y2-n.cropperScaledMaxHeight),i.y2-n.cropperScaledMinHeight);break;case"topright":i.x2=Math.max(Math.min(t.x2+c,i.x1+n.cropperScaledMaxWidth),i.x1+n.cropperScaledMinWidth),i.y1=Math.min(Math.max(t.y1+g,i.y2-n.cropperScaledMaxHeight),i.y2-n.cropperScaledMinHeight);break;case"right":i.x2=Math.max(Math.min(t.x2+c,i.x1+n.cropperScaledMaxWidth),i.x1+n.cropperScaledMinWidth);break;case"bottomright":i.x2=Math.max(Math.min(t.x2+c,i.x1+n.cropperScaledMaxWidth),i.x1+n.cropperScaledMinWidth),i.y2=Math.max(Math.min(t.y2+g,i.y1+n.cropperScaledMaxHeight),i.y1+n.cropperScaledMinHeight);break;case"bottom":i.y2=Math.max(Math.min(t.y2+g,i.y1+n.cropperScaledMaxHeight),i.y1+n.cropperScaledMinHeight);break;case"bottomleft":i.x1=Math.min(Math.max(t.x1+c,i.x2-n.cropperScaledMaxWidth),i.x2-n.cropperScaledMinWidth),i.y2=Math.max(Math.min(t.y2+g,i.y1+n.cropperScaledMaxHeight),i.y1+n.cropperScaledMinHeight);break;case"center":let x=e.scale,f=Math.min(Math.max(n.cropperScaledMinWidth,Math.abs(t.x2-t.x1)*x),n.cropperScaledMaxWidth),M=Math.min(Math.max(n.cropperScaledMinHeight,Math.abs(t.y2-t.y1)*x),n.cropperScaledMaxHeight);i.x1=t.clientX-f/2,i.x2=t.clientX+f/2,i.y1=t.clientY-M/2,i.y2=t.clientY+M/2,i.x1<0?(i.x2-=i.x1,i.x1=0):i.x2>r.width&&(i.x1-=i.x2-r.width,i.x2=r.width),i.y1<0?(i.y2-=i.y1,i.y1=0):i.y2>r.height&&(i.y1-=i.y2-r.height,i.y2=r.height);break}n.maintainAspectRatio&&this.checkAspectRatio(t.position,i,r,n)}checkAspectRatio(e,t,i,r){let n=0,c=0;switch(e){case"top":t.x2=t.x1+(t.y2-t.y1)*r.aspectRatio,n=Math.max(t.x2-i.width,0),c=Math.max(0-t.y1,0),(n>0||c>0)&&(t.x2-=c*r.aspectRatio>n?c*r.aspectRatio:n,t.y1+=c*r.aspectRatio>n?c:n/r.aspectRatio);break;case"bottom":t.x2=t.x1+(t.y2-t.y1)*r.aspectRatio,n=Math.max(t.x2-i.width,0),c=Math.max(t.y2-i.height,0),(n>0||c>0)&&(t.x2-=c*r.aspectRatio>n?c*r.aspectRatio:n,t.y2-=c*r.aspectRatio>n?c:n/r.aspectRatio);break;case"topleft":t.y1=t.y2-(t.x2-t.x1)/r.aspectRatio,n=Math.max(0-t.x1,0),c=Math.max(0-t.y1,0),(n>0||c>0)&&(t.x1+=c*r.aspectRatio>n?c*r.aspectRatio:n,t.y1+=c*r.aspectRatio>n?c:n/r.aspectRatio);break;case"topright":t.y1=t.y2-(t.x2-t.x1)/r.aspectRatio,n=Math.max(t.x2-i.width,0),c=Math.max(0-t.y1,0),(n>0||c>0)&&(t.x2-=c*r.aspectRatio>n?c*r.aspectRatio:n,t.y1+=c*r.aspectRatio>n?c:n/r.aspectRatio);break;case"right":case"bottomright":t.y2=t.y1+(t.x2-t.x1)/r.aspectRatio,n=Math.max(t.x2-i.width,0),c=Math.max(t.y2-i.height,0),(n>0||c>0)&&(t.x2-=c*r.aspectRatio>n?c*r.aspectRatio:n,t.y2-=c*r.aspectRatio>n?c:n/r.aspectRatio);break;case"left":case"bottomleft":t.y2=t.y1+(t.x2-t.x1)/r.aspectRatio,n=Math.max(0-t.x1,0),c=Math.max(t.y2-i.height,0),(n>0||c>0)&&(t.x1+=c*r.aspectRatio>n?c*r.aspectRatio:n,t.y2-=c*r.aspectRatio>n?c:n/r.aspectRatio);break;case"center":t.x2=t.x1+(t.y2-t.y1)*r.aspectRatio,t.y2=t.y1+(t.x2-t.x1)/r.aspectRatio;let g=Math.max(0-t.x1,0),x=Math.max(t.x2-i.width,0),f=Math.max(t.y2-i.height,0),M=Math.max(0-t.y1,0);(g>0||x>0||f>0||M>0)&&(t.x1+=f*r.aspectRatio>g?f*r.aspectRatio:g,t.x2-=M*r.aspectRatio>x?M*r.aspectRatio:x,t.y1+=M*r.aspectRatio>x?M:x/r.aspectRatio,t.y2-=f*r.aspectRatio>g?f:g/r.aspectRatio);break}}getClientX(e){return e.touches?.[0].clientX||e.clientX||0}getClientY(e){return e.touches?.[0].clientY||e.clientY||0}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=P({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),ni="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==";function ai(){return new Promise(o=>{let p=new Image;p.onload=()=>{let e=p.width===1&&p.height===2;o(e)},p.src=ni})}function si(o){switch(typeof o=="object"&&(o=ci(o)),o){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}function ci(o){let p=new DataView(o);if(p.getUint16(0,!1)!==65496)return-2;let e=p.byteLength,t=2;for(;t<e;){if(p.getUint16(t+2,!1)<=8)return-1;let i=p.getUint16(t,!1);if(t+=2,i==65505){if(p.getUint32(t+=2,!1)!==1165519206)return-1;let r=p.getUint16(t+=6,!1)==18761;t+=p.getUint32(t+4,r);let n=p.getUint16(t,r);t+=2;for(let c=0;c<n;c++)if(p.getUint16(t+c*12,r)==274)return p.getUint16(t+c*12+8,r)}else{if((i&65280)!==65280)break;t+=p.getUint16(t,!1)}}return-1}var pi=(()=>{class o{constructor(){this.autoRotateSupported=ai()}loadImageFile(e,t){return B(this,null,function*(){let i=yield e.arrayBuffer();return yield this.checkImageTypeAndLoadImageFromArrayBuffer(i,e.type,t)})}checkImageTypeAndLoadImageFromArrayBuffer(e,t,i){return this.isValidImageType(t)?this.loadImageFromArrayBuffer(e,i,t):Promise.reject(new Error("Invalid image type"))}isValidImageType(e){return/image\/(png|jpg|jpeg|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(e)}loadImageFromURL(e,t){return B(this,null,function*(){let r=yield(yield fetch(e)).blob(),n=yield r.arrayBuffer();return yield this.loadImageFromArrayBuffer(n,t,r.type)})}loadBase64Image(e,t){let i=this.base64ToArrayBuffer(e);return this.loadImageFromArrayBuffer(i,t)}base64ToArrayBuffer(e){e=e.replace(/^data:([^;]+);base64,/gmi,"");let t=atob(e),i=t.length,r=new Uint8Array(i);for(let n=0;n<i;n++)r[n]=t.charCodeAt(n);return r.buffer}loadImageFromArrayBuffer(e,t,i){return B(this,null,function*(){let r=yield new Promise((n,c)=>B(this,null,function*(){try{let g=new Blob([e],i?{type:i}:void 0),x=URL.createObjectURL(g),f=new Image,I=i==="image/svg+xml"?yield this.getSvgImageSize(g):void 0;f.onload=()=>n({originalImage:f,originalImageSize:I,originalObjectUrl:x,originalArrayBuffer:e}),f.onerror=c,f.src=x}catch(g){c(g)}}));return yield this.transformImageFromArrayBuffer(r,t,r.originalImageSize!=null)})}getSvgImageSize(e){return B(this,null,function*(){let r=new DOMParser().parseFromString(yield e.text(),"image/svg+xml").querySelector("svg");if(!r)throw Error("Failed to parse SVG image");let n=r.getAttribute("width"),c=r.getAttribute("height");if(n&&c)return null;let g=r.getAttribute("viewBox")||r.getAttribute("viewbox");if(g){let x=g.split(" ");return{width:+x[2],height:+x[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})}transformImageFromArrayBuffer(e,t,i=!1){return B(this,null,function*(){let r=yield this.autoRotateSupported,n=si(r?-1:e.originalArrayBuffer);if(!e.originalImage||!e.originalImage.complete)return Promise.reject(new Error("No image loaded"));let c={original:{objectUrl:e.originalObjectUrl,image:e.originalImage,size:e.originalImageSize??{width:e.originalImage.naturalWidth,height:e.originalImage.naturalHeight}},exifTransform:n};return this.transformLoadedImage(c,t,i)})}transformLoadedImage(e,t,i=!1){return B(this,null,function*(){let r=t.canvasRotation+e.exifTransform.rotate,n=e.original.size;if(!i&&r===0&&!e.exifTransform.flip&&!t.containWithinAspectRatio)return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:k({},n)},transformed:{objectUrl:e.original.objectUrl,image:e.original.image,size:k({},n)},exifTransform:e.exifTransform};let c=this.getTransformedSize(n,e.exifTransform,t),g=document.createElement("canvas");g.width=c.width,g.height=c.height;let x=g.getContext("2d");x?.setTransform(e.exifTransform.flip?-1:1,0,0,1,g.width/2,g.height/2),x?.rotate(Math.PI*(r/2)),x?.drawImage(e.original.image,-n.width/2,-n.height/2);let f=yield new Promise(W=>g.toBlob(W,t.format));if(!f)throw new Error("Failed to get Blob for transformed image.");let M=URL.createObjectURL(f),I=yield this.loadImageFromObjectUrl(M);return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:k({},n)},transformed:{objectUrl:M,image:I,size:{width:I.width,height:I.height}},exifTransform:e.exifTransform}})}loadImageFromObjectUrl(e){return new Promise((t,i)=>{let r=new Image;r.onload=()=>t(r),r.onerror=i,r.src=e})}getTransformedSize(e,t,i){let r=i.canvasRotation+t.rotate;if(i.containWithinAspectRatio)if(r%2){let n=e.width*i.aspectRatio,c=e.height/i.aspectRatio;return{width:Math.max(e.height,n),height:Math.max(e.width,c)}}else{let n=e.height*i.aspectRatio,c=e.width/i.aspectRatio;return{width:Math.max(e.width,n),height:Math.max(e.height,c)}}return r%2?{height:e.width,width:e.height}:{width:e.width,height:e.height}}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=P({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Ot=(()=>{class o{constructor(e,t,i,r,n,c,g){this.cropService=e,this.cropperPositionService=t,this.loadImageService=i,this.sanitizer=r,this.cd=n,this.zone=c,this.hammerLoader=g,this.settings=new Ze,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=V,this.imageVisible=!1,this.cropperFrameAriaLabel=this.settings.cropperFrameAriaLabel,this.output=this.settings.output,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new $,this.startCropImage=new $,this.imageLoaded=new $,this.cropperReady=new $,this.loadImageFailed=new $,this.transformChange=new $,this.reset()}ngOnChanges(e){this.onChangesUpdateSettings(e),this.onChangesInputImage(e),this.loadedImage?.original.image.complete&&(e.containWithinAspectRatio||e.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t)),(e.cropper||e.maintainAspectRatio||e.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(this.resetCropOnAspectRatioChange||!this.aspectRatioIsCorrect())&&(e.maintainAspectRatio||e.aspectRatio)?this.resetCropperPosition():e.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop())),e.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop()),e.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(e){this.settings.setOptionsFromChanges(e),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&(this.hideResizeSquares=!0,this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1}))}onChangesInputImage(e){(e.imageChangedEvent||e.imageURL||e.imageBase64||e.imageFile)&&this.reset(),e.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),e.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),e.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),e.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent?.target?.files?.length>0}setCssTransform(){let e=this.transform?.translateUnit||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${e}, ${this.transform.translateV||0}${e}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(e){this.loadImageService.loadImageFile(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadBase64Image(e){this.loadImageService.loadBase64Image(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadImageFromURL(e){this.loadImageService.loadImageFromURL(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}setLoadedImage(e){this.loadedImage=e,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e.transformed.objectUrl),this.cd.markForCheck()}loadImageError(e){console.error(e),this.loadImageFailed.emit()}imageLoadedInView(){this.loadedImage!=null&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit(k({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){if(this.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{let e=k({},this.maxSize);this.setMaxSize(),this.resizeCropperPosition(e),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}}activatePinchGesture(){return B(this,null,function*(){yield this.hammerLoader?.();let e=window?.Hammer||null;if(e){let t=new e(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else vt()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")})}resizeCropperPosition(e){(e.width!==this.maxSize.width||e.height!==this.maxSize.height)&&(this.cropper.x1=this.cropper.x1*this.maxSize.width/e.width,this.cropper.x2=this.cropper.x2*this.maxSize.width/e.width,this.cropper.y1=this.cropper.y1*this.maxSize.height/e.height,this.cropper.y2=this.cropper.y2*this.maxSize.height/e.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings,this.maxSize),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(e){this.changeKeyboardStepSize(e),this.keyboardMoveCropper(e)}changeKeyboardStepSize(e){let t=+e.key;t>=1&&t<=9&&(this.settings.stepSize=t)}keyboardMoveCropper(e){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(e.key))return;let i=e.shiftKey?V.Resize:V.Move,r=e.altKey?ei(e.key):Zt(e.key),n=ti(e.key,this.settings.stepSize);e.preventDefault(),e.stopPropagation(),this.startMove({clientX:0,clientY:0},i,r),this.handleMouseMove(n),this.handleMouseUp()}startMove(e,t,i=null){this.disabled||this.moveStart?.active&&this.moveStart?.type===V.Pinch||t===V.Drag&&!this.allowMoveImage||(e.preventDefault&&e.preventDefault(),this.moveStart=k({active:!0,type:t,position:i,transform:k({},this.transform),clientX:this.cropperPositionService.getClientX(e),clientY:this.cropperPositionService.getClientY(e)},this.cropper),this.initMouseMove())}initMouseMove(){Ke(xe(document,"mousemove"),xe(document,"touchmove")).pipe(pt(Ke(xe(document,"mouseup"),xe(document,"touchend")).pipe(ct()))).subscribe({next:e=>this.zone.run(()=>{this.handleMouseMove(e),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}startPinch(e){this.safeImgDataUrl&&(e.preventDefault&&e.preventDefault(),this.moveStart=k({active:!0,type:V.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}handleMouseMove(e){if(this.moveStart.active){if(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.moveStart.type===V.Move)this.cropperPositionService.move(e,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===V.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(e,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===V.Drag){let t=this.cropperPositionService.getClientX(e)-this.moveStart.clientX,i=this.cropperPositionService.getClientY(e)-this.moveStart.clientY;this.transform=st(k({},this.transform),{translateH:(this.moveStart.transform?.translateH||0)+t,translateV:(this.moveStart.transform?.translateV||0)+i}),this.setCssTransform()}}}onPinch(e){this.moveStart.active&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.moveStart.type===V.Pinch&&(this.cropperPositionService.resize(e,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.markForCheck())}setMaxSize(){if(this.sourceImage){let e=getComputedStyle(this.sourceImage.nativeElement);this.maxSize.width=parseFloat(e.width),this.maxSize.height=parseFloat(e.height),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.maintainAspectRatio?this.settings.cropperScaledMinHeight=Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?this.settings.cropperScaledMinHeight=Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):this.settings.cropperScaledMinHeight=20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){let e=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/e:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/e:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(e=!1){this.cropper.x1<0&&(this.cropper.x2-=e?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=e?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=e?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=e?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}handleMouseUp(){this.moveStart.active&&(this.moveStart.active=!1,this.moveStart?.type===V.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(e=this.settings.output){if(this.loadedImage?.transformed?.image!=null){if(this.startCropImage.emit(),e==="blob")return this.cropToBlob();if(e==="base64")return this.cropToBase64()}return null}cropToBlob(){return new Promise((e,t)=>this.zone.run(()=>B(this,null,function*(){let i=yield this.cropService.crop(this.loadedImage,this.cropper,this.settings,"blob",this.maxSize);i?(this.imageCropped.emit(i),e(i)):t("Crop image failed")})))}cropToBase64(){let e=this.cropService.crop(this.loadedImage,this.cropper,this.settings,"base64",this.maxSize);return e?(this.imageCropped.emit(e),e):null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return o.\u0275fac=function(e){return new(e||o)(C(ri),C(oi),C(pi),C(Mt),C(_t),C(dt),C(yt,8))},o.\u0275cmp=R({type:o,selectors:[["image-cropper"]],viewQuery:function(e,t){if(e&1&&(J(Xt,7),J(Gt,5)),e&2){let i;Z(i=ee())&&(t.wrapper=i.first),Z(i=ee())&&(t.sourceImage=i.first)}},hostVars:6,hostBindings:function(e,t){e&1&&w("resize",function(){return t.onResize()},!1,ht),e&2&&(U("text-align",t.alignImage),Re("disabled",t.disabled)("ngx-ix-hidden",t.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},features:[lt],decls:5,vars:10,consts:[["wrapper",""],["sourceImage",""],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(e,t){e&1&&(s(0,"div",null,0),y(2,Kt,2,8,"img",2),h(3,"div",3),y(4,Jt,3,16,"div",4),a()),e&2&&(U("background",t.imageVisible&&t.backgroundColor),m(2),d("ngIf",t.safeImgDataUrl),m(),U("width",t.maxSize.width,"px")("height",t.maxSize.height,"px")("margin-left",t.alignImage==="center"?t.marginLeft:null),m(),d("ngIf",t.imageVisible))},dependencies:[le],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),o})(),Vt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=ce({type:o}),o.\u0275inj=ae({imports:[[He]]}),o})();var ye=o=>({"is-invalid":o});function di(o,p){if(o&1&&(s(0,"li"),l(1),a()),o&2){let e=p.$implicit;m(),te(e)}}function hi(o,p){if(o&1&&(s(0,"div",25)(1,"h3",26),l(2,"Opa! Alguma coisa n\xE3o deu certo:"),a(),s(3,"ul"),y(4,di,2,1,"li",27),a()()),o&2){let e=u();m(4),d("ngForOf",e.errors)}}function gi(o,p){if(o&1&&(s(0,"option",28),l(1),a()),o&2){let e=p.$implicit;ze("value",e.id),m(),te(e.nome)}}function ui(o,p){if(o&1&&(s(0,"span",29),h(1,"p",30),a()),o&2){let e=u();m(),d("innerHTML",e.displayMessage.fornecedorId,T)}}function fi(o,p){if(o&1&&(s(0,"span",29),h(1,"p",30),a()),o&2){let e=u();m(),d("innerHTML",e.displayMessage.nome,T)}}function xi(o,p){if(o&1&&(s(0,"span",29),h(1,"p",30),a()),o&2){let e=u();m(),d("innerHTML",e.displayMessage.descricao,T)}}function vi(o,p){if(o&1&&(s(0,"span"),h(1,"br"),l(2),h(3,"br"),a()),o&2){let e=u();m(2),te(e.imagemNome)}}function _i(o,p){if(o&1&&(s(0,"span",29),h(1,"p",30),a()),o&2){let e=u();m(),d("innerHTML",e.displayMessage.imagem,T)}}function Ci(o,p){if(o&1){let e=N();s(0,"div",3)(1,"div",31)(2,"image-cropper",32),w("imageCropped",function(i){v(e);let r=u();return _(r.imageCropped(i))})("imageLoaded",function(){v(e);let i=u();return _(i.imageLoaded())})("cropperReady",function(i){v(e);let r=u();return _(r.cropperReady(i))})("loadImageFailed",function(){v(e);let i=u();return _(i.loadImageFailed())}),a()(),s(3,"div",31),h(4,"img",33),a()()}if(o&2){let e=u();m(2),U("display",e.showCropper?null:"none"),d("imageChangedEvent",e.imageChangedEvent)("maintainAspectRatio",!1)("containWithinAspectRatio",e.containWithinAspectRatio)("aspectRatio",4/3)("resizeToWidth",256)("cropperMinWidth",128)("onlyScaleDown",!0)("roundCropper",!1)("canvasRotation",e.canvasRotation)("transform",e.transform)("alignImage","left"),m(2),U("border",e.croppedImage?"1px solid black":"none"),d("src",e.croppedImage,F)}}function yi(o,p){if(o&1&&(s(0,"span",29),h(1,"p",30),a()),o&2){let e=u();m(),d("innerHTML",e.displayMessage.valor,T)}}var kt=(()=>{class o extends ge{fb;produtoService;router;toastr;spinner;formInputElements;imageChangedEvent="";croppedImage="";canvasRotation=0;rotation=0;scale=1;showCropper=!1;containWithinAspectRatio=!1;transform={};imageURL;imagemNome;constructor(e,t,i,r,n){super(),this.fb=e,this.produtoService=t,this.router=i,this.toastr=r,this.spinner=n}ngOnInit(){this.produtoService.obterFornecedores().subscribe(e=>this.fornecedores=e),this.produtoForm=this.fb.group({fornecedorId:["",[S.required]],nome:["",[S.required,S.minLength(2),S.maxLength(200)]],descricao:["",[S.required,S.minLength(2),S.maxLength(1e3)]],imagem:["",[S.required]],valor:["",[S.required]],ativo:[!0]})}ngAfterViewInit(){super.configurarValidacaoFormulario(this.formInputElements)}adicionarProduto(){this.spinner.show(),this.produtoForm.dirty&&this.produtoForm.valid&&(this.produto=Object.assign({},this.produto,this.produtoForm.value),this.produto.imagemUpload=this.croppedImage.split(",")[1],this.produto.imagem=this.imagemNome,this.produto.valor=ie.StringParaDecimal(this.produto.valor),this.produtoService.novoProduto(this.produto).subscribe({next:e=>{this.processarSucesso(e)},error:e=>{this.processarFalha(e)}}),this.mudancasNaoSalvas=!1),setTimeout(()=>{this.spinner.hide()},1e3)}processarSucesso(e){this.produtoForm.reset(),this.errors=[];let t=this.toastr.success("Produto cadastrado com sucesso!","Sucesso!");t&&t.onHidden.subscribe(()=>{this.router.navigate(["/produtos/listar-todos"])})}processarFalha(e){this.errors=e.error.errors,this.toastr.error("Ocorreu um erro!","Opa :(")}fileChangeEvent(e){this.imageChangedEvent=e,this.imagemNome=e.currentTarget.files[0].name}imageCropped(e){let t=e.blob;this.convertBlobToBase64(t).then(i=>{this.croppedImage=i})}imageLoaded(){this.showCropper=!0}cropperReady(e){console.log("Cropper ready",e)}loadImageFailed(){this.errors.push("O formato do arquivo "+this.imagemNome+" n\xE3o \xE9 aceito.")}convertBlobToBase64(e){return new Promise((t,i)=>{let r=new FileReader;r.readAsDataURL(e),r.onloadend=()=>{t(r.result)},r.onerror=i})}static \u0275fac=function(t){return new(t||o)(C(Ye),C(O),C(Y),C(he),C(Et))};static \u0275cmp=R({type:o,selectors:[["app-produto-add"]],viewQuery:function(t,i){if(t&1&&J(X,5,Ie),t&2){let r;Z(r=ee())&&(i.formInputElements=r)}},features:[Ee],decls:53,vars:26,consts:[[1,"container","main-container"],["bdColor","rgba(51,51,51,0.8)","size","medium","color","#fff","type","ball-scale-multiple"],[2,"font-size","20px","color","white"],[1,"row"],[1,"col-md-10"],["enctype","multipart/form-data",3,"ngSubmit","formGroup"],["class","alert alert-danger",4,"ngIf"],[1,"form-group"],[1,"control-label"],["id","fornecedorId","formControlName","fornecedorId",1,"form-control",3,"ngClass"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],["id","nome","type","text","placeholder","Nome (requerido)","formControlName","nome",1,"form-control",3,"ngClass"],["cols","40","rows","5","maxlength","1000","id","descricao","placeholder","Descri\xE7\xE3o (requerido)","formControlName","descricao",1,"form-control",3,"ngClass"],[1,"custom-file"],["type","file","accept","image/jpeg,image/png","id","imagem","formControlName","imagem",1,"custom-file-input",3,"change","ngClass"],["data-browse","Procurar",1,"custom-file-label",2,"width","400px"],[4,"ngIf"],["class","row",4,"ngIf"],["id","valor","type","text","placeholder","Valor (requerido)","formControlName","valor",1,"form-control",3,"ngClass"],[1,"form-group","form-check"],[1,"form-check-label"],["type","checkbox","id","ativo","formControlName","ativo","name","ativo","value","true",1,"form-check-input"],["type","submit","id","cadastroProduto","value","Cadastrar",1,"btn","btn-primary",3,"disabled"],["href","/produtos/listar-todos",1,"btn","btn-info"],[1,"alert","alert-danger"],["id","msgRetorno"],[4,"ngFor","ngForOf"],[3,"value"],[1,"text-danger"],[3,"innerHTML"],[1,"col","col-md-6"],["format","png",3,"imageCropped","imageLoaded","cropperReady","loadImageFailed","imageChangedEvent","maintainAspectRatio","containWithinAspectRatio","aspectRatio","resizeToWidth","cropperMinWidth","onlyScaleDown","roundCropper","canvasRotation","transform","alignImage"],[3,"src"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"ngx-spinner",1)(2,"p",2),l(3,"Loading..."),a()(),s(4,"h3"),l(5,"Novo Produto "),a(),h(6,"hr"),s(7,"div",3)(8,"div",4)(9,"form",5),w("ngSubmit",function(){return i.adicionarProduto()}),y(10,hi,5,1,"div",6),s(11,"div",7)(12,"label",8),l(13,"Fornecedor"),a(),s(14,"select",9),y(15,gi,2,2,"option",10),a(),y(16,ui,2,1,"span",11),a(),s(17,"div",7)(18,"label",8),l(19,"Nome"),a(),s(20,"div"),h(21,"input",12),y(22,fi,2,1,"span",11),a()(),s(23,"div",7)(24,"label",8),l(25,"Descri\xE7\xE3o"),a(),s(26,"div"),h(27,"textarea",13),y(28,xi,2,1,"span",11),a()(),s(29,"div",7)(30,"label",8),l(31,"Imagem do Produto"),a(),s(32,"div",14)(33,"input",15),w("change",function(n){return i.fileChangeEvent(n)}),a(),h(34,"label",16),y(35,vi,4,1,"span",17)(36,_i,2,1,"span",11),a(),y(37,Ci,5,16,"div",18),a(),s(38,"div",7)(39,"label",8),l(40,"Valor"),a(),s(41,"div"),h(42,"input",19),y(43,yi,2,1,"span",11),a()(),s(44,"div",20)(45,"label",21),h(46,"input",22),l(47," Ativo? "),a()(),s(48,"div",7),h(49,"input",23),l(50,"\xA0 "),s(51,"a",24),l(52,"Voltar"),a()()()()()()),t&2&&(m(9),d("formGroup",i.produtoForm),m(),d("ngIf",i.errors.length>0),m(4),d("ngClass",A(16,ye,i.displayMessage.fornecedorId)),m(),d("ngForOf",i.fornecedores),m(),d("ngIf",i.displayMessage.fornecedorId),m(5),d("ngClass",A(18,ye,i.displayMessage.nome)),m(),d("ngIf",i.displayMessage.nome),m(5),d("ngClass",A(20,ye,i.displayMessage.descricao)),m(),d("ngIf",i.displayMessage.descricao),m(5),d("ngClass",A(22,ye,i.displayMessage.imagem)),m(2),d("ngIf",i.imagemNome),m(),d("ngIf",i.displayMessage.imagem),m(),d("ngIf",i.imagemNome),m(5),d("ngClass",A(24,ye,i.displayMessage.valor)),m(),d("ngIf",i.displayMessage.valor),m(6),d("disabled",!i.produtoForm.valid))},dependencies:[Oe,me,le,Rt,We,Qe,Ne,Le,Be,je,De,Pe,qe,Ue,X,Ot]})}return o})();E();var Bt=(()=>{class o{static \u0275fac=function(t){return new(t||o)};static \u0275cmp=R({type:o,selectors:[["produto-app-root"]],decls:1,vars:0,template:function(t,i){t&1&&h(0,"router-outlet")},dependencies:[wt],encapsulation:2})}return o})();E();q();var Mi=()=>["/produtos/adicionar-novo"],wi=o=>["/produtos/detalhes",o],bi=o=>["/produtos/editar",o],Si=o=>["/produtos/excluir",o];function Ai(o,p){if(o&1&&(s(0,"tr")(1,"td"),h(2,"img",5),a(),s(3,"td"),l(4),a(),s(5,"td"),l(6),a(),s(7,"td"),l(8),a(),s(9,"td"),h(10,"input",6),a(),s(11,"td",7)(12,"a",8),h(13,"span",9),a(),l(14,"\xA0 "),s(15,"a",1),h(16,"span",10),a(),l(17,"\xA0 "),s(18,"a",11),h(19,"span",12),a()()()),o&2){let e=p.$implicit,t=u();m(2),pe("src","",t.imagens,"",e.imagem,"",F),m(2),b(" ",e.nome," "),m(2),b(" ",e.nomeFornecedor," "),m(2),b(" ",e.valor," "),m(2),d("checked",e.ativo),m(2),d("routerLink",A(10,wi,e.id)),m(3),d("routerLink",A(12,bi,e.id)),m(3),d("routerLink",A(14,Si,e.id))}}var Lt=(()=>{class o{produtoService;imagens=G.imagensUrl;produtos;errorMessage;constructor(e){this.produtoService=e}ngOnInit(){this.produtoService.obterTodos().subscribe({next:e=>{this.produtos=e},error:e=>this.errorMessage=e})}static \u0275fac=function(t){return new(t||o)(C(O))};static \u0275cmp=R({type:o,selectors:[["app-produto-lista"]],decls:22,vars:3,consts:[[1,"container","main-container"],[1,"btn","btn-info",3,"routerLink"],[1,"table","table-hover"],[1,"thead-dark"],[4,"ngFor","ngForOf"],[2,"width","70px","height","100px",3,"src"],["disabled","disabled","type","checkbox",1,"check-box",3,"checked"],[1,"text-right"],[1,"btn","btn-warning",3,"routerLink"],[1,"fa","fa-search"],[1,"fa","fa-pencil-alt"],[1,"btn","btn-danger",3,"routerLink"],[1,"fa","fa-trash"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"h1"),l(2,"Lista de Produtos"),a(),h(3,"hr"),s(4,"p")(5,"a",1),l(6,"Novo Produto"),a()(),s(7,"table",2)(8,"thead",3)(9,"tr"),h(10,"th"),s(11,"th"),l(12," Nome "),a(),s(13,"th"),l(14," Fornecedor "),a(),s(15,"th"),l(16," Valor "),a(),s(17,"th"),l(18," Ativo? "),a(),h(19,"th"),a()(),s(20,"tbody"),y(21,Ai,20,16,"tr",4),a()()()),t&2&&(m(5),d("routerLink",xt(2,Mi)),m(16),d("ngForOf",i.produtos))},dependencies:[me,ke]})}return o})();E();ve();E();ve();q();var Me=o=>({"is-invalid":o});function Ii(o,p){if(o&1&&(s(0,"li"),l(1),a()),o&2){let e=p.$implicit;m(),te(e)}}function Ei(o,p){if(o&1&&(s(0,"div",23)(1,"h3",24),l(2,"Opa! Alguma coisa n\xE3o deu certo:"),a(),s(3,"ul"),y(4,Ii,2,1,"li",25),a()()),o&2){let e=u();m(4),d("ngForOf",e.errors)}}function Ri(o,p){if(o&1&&(s(0,"option",26),l(1),a()),o&2){let e=p.$implicit;ze("value",e.id),m(),te(e.nome)}}function zi(o,p){if(o&1&&(s(0,"span",27),h(1,"p",28),a()),o&2){let e=u();m(),d("innerHTML",e.displayMessage.fornecedorId,T)}}function Fi(o,p){if(o&1&&(s(0,"span",27),h(1,"p",28),a()),o&2){let e=u();m(),d("innerHTML",e.displayMessage.nome,T)}}function Ti(o,p){if(o&1&&(s(0,"span",27),h(1,"p",28),a()),o&2){let e=u();m(),d("innerHTML",e.displayMessage.descricao,T)}}function Oi(o,p){if(o&1&&(s(0,"div",6)(1,"label"),l(2,"Imagem Atual"),a(),h(3,"br")(4,"img",29),a()),o&2){let e=u();m(4),d("src",e.imagemOriginalSrc,F)}}function Vi(o,p){if(o&1&&(s(0,"div",6)(1,"label"),l(2,"Nova Imagem"),a(),h(3,"br")(4,"img",29),a()),o&2){let e=u();m(4),d("src",e.imagemPreview,F)}}function Hi(o,p){if(o&1&&(s(0,"span",27),h(1,"p",28),a()),o&2){let e=u();m(),d("innerHTML",e.displayMessage.imagem,T)}}function ki(o,p){if(o&1&&(s(0,"span",27),h(1,"p",28),a()),o&2){let e=u();m(),d("innerHTML",e.displayMessage.valor,T)}}var Dt=(()=>{class o extends ge{fb;produtoService;router;route;toastr;imagens=G.imagensUrl;formInputElements;imageBase64;imagemPreview;imagemNome;imagemOriginalSrc;constructor(e,t,i,r,n){super(),this.fb=e,this.produtoService=t,this.router=i,this.route=r,this.toastr=n,this.produto=this.route.snapshot.data.produto}ngOnInit(){this.produtoService.obterFornecedores().subscribe(e=>this.fornecedores=e),this.produtoForm=this.fb.group({fornecedorId:["",[S.required]],nome:["",[S.required,S.minLength(2),S.maxLength(200)]],descricao:["",[S.required,S.minLength(2),S.maxLength(1e3)]],imagem:[""],valor:["",[S.required]],ativo:[0]}),this.produtoForm.patchValue({fornecedorId:this.produto.fornecedorId,id:this.produto.id,nome:this.produto.nome,descricao:this.produto.descricao,ativo:this.produto.ativo,valor:ie.DecimalParaString(this.produto.valor)}),this.imagemOriginalSrc=this.imagens+this.produto.imagem}ngAfterViewInit(){super.configurarValidacaoFormulario(this.formInputElements)}editarProduto(){this.produtoForm.dirty&&this.produtoForm.valid&&(this.produto=Object.assign({},this.produto,this.produtoForm.value),this.imageBase64&&(this.produto.imagemUpload=this.imageBase64,this.produto.imagem=this.imagemNome),this.produto.valor=ie.StringParaDecimal(this.produto.valor),this.produtoService.atualizarProduto(this.produto).subscribe(e=>{this.processarSucesso(e)},e=>{this.processarFalha(e)}),this.mudancasNaoSalvas=!1)}processarSucesso(e){this.produtoForm.reset(),this.errors=[];let t=this.toastr.success("Produto editado com sucesso!","Sucesso!");t&&t.onHidden.subscribe(()=>{this.router.navigate(["/produtos/listar-todos"])})}processarFalha(e){this.errors=e.error.errors,this.toastr.error("Ocorreu um erro!","Opa :(")}upload(e){this.imagemNome=e[0].name;var t=new FileReader;t.onload=this.manipularReader.bind(this),t.readAsBinaryString(e[0])}manipularReader(e){var t=e.target.result;this.imageBase64=btoa(t),this.imagemPreview="data:image/jpeg;base64,"+this.imageBase64}static \u0275fac=function(t){return new(t||o)(C(Ye),C(O),C(Y),C(de),C(he))};static \u0275cmp=R({type:o,selectors:[["app-editar"]],viewQuery:function(t,i){if(t&1&&J(X,5,Ie),t&2){let r;Z(r=ee())&&(i.formInputElements=r)}},features:[Ee],decls:51,vars:27,consts:[["fileInput",""],[1,"container","main-container"],[1,"row"],[1,"col-md-10"],["enctype","multipart/form-data",3,"ngSubmit","formGroup"],["class","alert alert-danger",4,"ngIf"],[1,"form-group"],[1,"control-label"],["id","fornecedorId","formControlName","fornecedorId",1,"form-control",3,"ngClass"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],["id","nome","type","text","placeholder","Nome (requerido)","formControlName","nome",1,"form-control",3,"ngClass"],["cols","40","rows","5","maxlength","1000","id","descricao","placeholder","Descri\xE7\xE3o (requerido)","formControlName","descricao",1,"form-control",3,"ngClass"],["class","form-group",4,"ngIf"],[1,"custom-file"],["type","file","accept","image/jpeg,image/png","id","imagem","formControlName","imagem",1,"custom-file-input",3,"change","ngClass"],["data-browse","Procurar",1,"custom-file-label",2,"width","400px"],["id","valor","type","text","placeholder","Valor (requerido)","formControlName","valor",1,"form-control",3,"ngClass"],[1,"form-group","form-check"],[1,"form-check-label"],["type","checkbox","id","ativo","formControlName","ativo","name","ativo","value","true",1,"form-check-input"],["type","submit","value","Editar",1,"btn","btn-primary",3,"disabled"],["href","/produtos/listar-todos",1,"btn","btn-info"],[1,"alert","alert-danger"],["id","msgRetorno"],[4,"ngFor","ngForOf"],[3,"value"],[1,"text-danger"],[3,"innerHTML"],[2,"width","70px","height","100px",3,"src"]],template:function(t,i){if(t&1){let r=N();s(0,"div",1)(1,"h3"),l(2),a(),h(3,"hr"),s(4,"div",2)(5,"div",3)(6,"form",4),w("ngSubmit",function(){return v(r),_(i.editarProduto())}),y(7,Ei,5,1,"div",5),s(8,"div",6)(9,"label",7),l(10,"Fornecedor"),a(),s(11,"select",8),y(12,Ri,2,2,"option",9),a(),y(13,zi,2,1,"span",10),a(),s(14,"div",6)(15,"label",7),l(16,"Nome"),a(),s(17,"div"),h(18,"input",11),y(19,Fi,2,1,"span",10),a()(),s(20,"div",6)(21,"label",7),l(22,"Descri\xE7\xE3o"),a(),s(23,"div"),h(24,"textarea",12),y(25,Ti,2,1,"span",10),a()(),y(26,Oi,5,1,"div",13)(27,Vi,5,1,"div",13),s(28,"div",6)(29,"label",7),l(30,"Imagem do Produto"),a(),s(31,"div",14)(32,"input",15,0),w("change",function(){v(r);let c=ft(33);return _(i.upload(c.files))}),a(),h(34,"label",16),y(35,Hi,2,1,"span",10),a()(),s(36,"div",6)(37,"label",7),l(38,"Valor"),a(),s(39,"div"),h(40,"input",17),y(41,ki,2,1,"span",10),a()(),s(42,"div",18)(43,"label",19),h(44,"input",20),l(45," Ativo? "),a()(),s(46,"div",6),h(47,"input",21),l(48,"\xA0 "),s(49,"a",22),l(50,"Voltar"),a()()()()()()}t&2&&(m(2),b("Editar Produto - ",i.produto.nome,""),m(4),d("formGroup",i.produtoForm),m(),d("ngIf",i.errors.length>0),m(4),d("ngClass",A(17,Me,i.displayMessage.fornecedorId)),m(),d("ngForOf",i.fornecedores),m(),d("ngIf",i.displayMessage.fornecedorId),m(5),d("ngClass",A(19,Me,i.displayMessage.nome)),m(),d("ngIf",i.displayMessage.nome),m(5),d("ngClass",A(21,Me,i.displayMessage.descricao)),m(),d("ngIf",i.displayMessage.descricao),m(),d("ngIf",!i.imagemPreview),m(),d("ngIf",i.imagemPreview),m(5),d("ngClass",A(23,Me,i.displayMessage.imagem)),m(3),d("ngIf",i.displayMessage.imagem),m(5),d("ngClass",A(25,Me,i.displayMessage.valor)),m(),d("ngIf",i.displayMessage.valor),m(6),d("disabled",!i.produtoForm.valid))},dependencies:[Oe,me,le,We,Qe,Ne,Le,Be,je,De,Pe,qe,Ue,X]})}return o})();E();q();var Pt=(()=>{class o{produtoService;route;router;toastr;imagens=G.imagensUrl;produto;constructor(e,t,i,r){this.produtoService=e,this.route=t,this.router=i,this.toastr=r,this.produto=this.route.snapshot.data.produto}excluirProduto(){this.produtoService.excluirProduto(this.produto.id).subscribe({next:e=>{this.sucessoExclusao(e)},error:e=>{this.falha()}})}sucessoExclusao(e){let t=this.toastr.success("Produto excluido com Sucesso!","Good bye :D");t&&t.onHidden.subscribe(()=>{this.router.navigate(["/produtos/listar-todos"])})}falha(){this.toastr.error("Houve um erro no processamento!","Ops! :(")}static \u0275fac=function(t){return new(t||o)(C(O),C(de),C(Y),C(he))};static \u0275cmp=R({type:o,selectors:[["app-excluir"]],decls:42,vars:13,consts:[[1,"container","main-container"],[1,"row"],[1,"col-md-4"],[2,"width","300px","height","428px",3,"src"],[1,"col-md-6"],["disabled","disabled","type","checkbox",1,"check-box",3,"checked"],["href","javascript:void(0)",1,"btn","btn-danger",3,"click"],["href","javascript:window.history.back();",1,"btn","btn-info"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"h4"),l(2),a(),h(3,"br"),s(4,"h5"),l(5,"Voc\xEA tem certeza disso?"),a(),s(6,"div",1)(7,"div",2),h(8,"img",3),a(),s(9,"div",4)(10,"dl")(11,"dt"),l(12," Fornecedor "),a(),s(13,"dd"),l(14),a(),s(15,"dt"),l(16," Nome "),a(),s(17,"dd"),l(18),a(),s(19,"dt"),l(20," Descri\xE7\xE3o "),a(),s(21,"dd"),l(22),a(),s(23,"dt"),l(24," Valor "),a(),s(25,"dd"),l(26),a(),s(27,"dt"),l(28," DataCadastro "),a(),s(29,"dd"),l(30),Fe(31,"date"),a(),s(32,"dt"),l(33," Ativo? "),a(),s(34,"dd"),h(35,"input",5),a()(),s(36,"div")(37,"a",6),w("click",function(){return i.excluirProduto()}),l(38,"Excluir"),a(),l(39,"\xA0 "),s(40,"a",7),l(41,"Voltar"),a()()()()()),t&2&&(m(2),b("Excluir ",i.produto.nome," "),m(6),pe("src","",i.imagens,"",i.produto.imagem,"",F),m(6),b(" ",i.produto.nomeFornecedor," "),m(4),b(" ",i.produto.nome," "),m(4),b(" ",i.produto.descricao," "),m(4),b(" ",i.produto.valor," "),m(4),b(" ",Te(31,10,i.produto.dataCadastro,"dd/MM/yyyy")," "),m(5),d("checked",i.produto.ativo))},dependencies:[Ve]})}return o})();E();q();var Bi=o=>["/produtos/editar",o],Wt=(()=>{class o{route;imagens=G.imagensUrl;produto;constructor(e){this.route=e,this.produto=this.route.snapshot.data.produto}static \u0275fac=function(t){return new(t||o)(C(de))};static \u0275cmp=R({type:o,selectors:[["app-detalhes"]],decls:42,vars:16,consts:[[1,"container","main-container"],[1,"row"],[1,"col-md-4"],[2,"width","300px","height","428px",3,"src"],[1,"col-md-6"],["disabled","disabled","type","checkbox",1,"check-box",3,"checked"],[1,"btn","btn-warning",3,"routerLink"],["href","javascript:window.history.back();",1,"btn","btn-info"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"h4"),l(2),a(),h(3,"br"),s(4,"h5"),l(5,"Voc\xEA tem certeza disso?"),a(),s(6,"div",1)(7,"div",2),h(8,"img",3),a(),s(9,"div",4)(10,"dl")(11,"dt"),l(12," Fornecedor "),a(),s(13,"dd"),l(14),a(),s(15,"dt"),l(16," Nome "),a(),s(17,"dd"),l(18),a(),s(19,"dt"),l(20," Descri\xE7\xE3o "),a(),s(21,"dd"),l(22),a(),s(23,"dt"),l(24," Valor "),a(),s(25,"dd"),l(26),a(),s(27,"dt"),l(28," DataCadastro "),a(),s(29,"dd"),l(30),Fe(31,"date"),a(),s(32,"dt"),l(33," Ativo? "),a(),s(34,"dd"),h(35,"input",5),a()(),s(36,"div")(37,"a",6),l(38,"Editar"),a(),l(39,"\xA0 "),s(40,"a",7),l(41,"Voltar"),a()()()()()),t&2&&(m(2),b("Excluir ",i.produto.nome," "),m(6),pe("src","",i.imagens,"",i.produto.imagem,"",F),m(6),b(" ",i.produto.nomeFornecedor," "),m(4),b(" ",i.produto.nome," "),m(4),b(" ",i.produto.descricao," "),m(4),b(" ",i.produto.valor," "),m(4),b(" ",Te(31,11,i.produto.dataCadastro,"dd/MM/yyyy")," "),m(5),d("checked",i.produto.ativo),m(2),d("routerLink",A(14,Bi,i.produto.id)))},dependencies:[ke,Ve]})}return o})();E();var re=(()=>{class o extends Ft{router;constructor(e){super(e),this.router=e}canActivate(e){return super.validarClaims(e)}static \u0275fac=function(t){return new(t||o)(se(Y))};static \u0275prov=P({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();E();var fe=(()=>{class o{produtoService;constructor(e){this.produtoService=e}resolve(e){return this.produtoService.obterPorId(e.params.id)}static \u0275fac=function(t){return new(t||o)(se(O))};static \u0275prov=P({token:o,factory:o.\u0275fac})}return o})();E();var Li=[{path:"",component:Bt,children:[{path:"listar-todos",component:Lt},{path:"adicionar-novo",component:kt,canDeactivate:[re],canActivate:[re],data:[{claim:{nome:"Produto",valor:"Adicionar"}}]},{path:"editar/:id",component:Dt,canActivate:[re],data:[{claim:{nome:"Produto",valor:"Atualizar"}}],resolve:{produto:fe}},{path:"detalhes/:id",component:Wt,resolve:{produto:fe}},{path:"excluir/:id",component:Pt,canActivate:[re],data:[{claim:{nome:"Produto",valor:"Excluir"}}],resolve:{produto:fe}}]}],Ut=(()=>{class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=ce({type:o});static \u0275inj=ae({imports:[Je.forChild(Li),Je]})}return o})();ve();E();var lo=(()=>{class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=ce({type:o});static \u0275inj=ae({providers:[O,fe,re],imports:[He,Ut,zt,bt,St,Vt]})}return o})();export{lo as a};
